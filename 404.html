<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø®Ø¯Ù…Ø§Øª Ø¨ÙˆØ±ØªØ±Ø§Ø¬</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    
    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
    
    * {
      font-family: 'Cairo', sans-serif;
      font-size: 18px;
    }
    
    /* Datalist and Select Styling */
    input[list]::-webkit-calendar-picker-indicator {
      filter: invert(1);
      cursor: pointer;
    }
    
    datalist {
      background: #0a0a0a;
      color: #F2BC1B;
    }
    
    option {
      background: #1a1a1a;
      color: #F2BC1B;
      padding: 8px 12px;
      font-size: 13px;
      transition: all 0.2s ease;
    }
    
    option:hover {
      background: #F2BC1B;
      color: #000;
    }
    
    select {
      background: #262626;
      border: 1px solid #404040;
      color: #F2BC1B;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 14px;
    }
    
    select option {
      background: #1a1a1a;
      color: #F2BC1B;
      padding: 8px;
    }
    
    select option:hover,
    select option:checked {
      background: #F2BC1B;
      color: #000;
    }
    
    /* Firefox specific */
    @-moz-document url-prefix() {
      option {
        background: #1a1a1a;
        color: #F2BC1B;
      }
      
      option:hover {
        background: #F2BC1B;
        color: #000;
      }
    }
    
    html, body {
      height: 100%;
      overflow: hidden;
      margin: 0;
      padding: 0;
    }
    
    .dashboard-wrapper {
      height: 100%;
      width: 100%;
      display: grid;
      grid-template-columns: 180px 1fr;
      background: #0a0a0a;
      overflow: hidden;
      position: relative;
      gap: 0;
    }
    
    /* Sidebar */
    .sidebar {
      background: linear-gradient(180deg, #1a1a1a 0%, #0f0f0f 100%);
      border-left: 2px solid #F2BC1B;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      padding: 6px;
      gap: 3px;
      position: relative;
      z-index: 100;
    }
    
    .sidebar::-webkit-scrollbar {
      width: 4px;
    }
    
    .sidebar::-webkit-scrollbar-track {
      background: #1a1a1a;
    }
    
    .sidebar::-webkit-scrollbar-thumb {
      background: #F2BC1B;
      border-radius: 2px;
    }
    
    .logo-section {
      text-align: center;
      padding: 6px 0 8px 0;
      border-bottom: 1px solid #333;
      margin-bottom: 6px;
    }
    
    .logo-section img {
      max-width: 80px;
      height: auto;
      margin: 0 auto 4px;
    }
    
    .logo-section h1 {
      font-size: 13px;
      font-weight: 700;
      color: #F2BC1B;
      margin: 0;
    }
    
    .service-item {
      background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
      border: 1px solid #404040;
      border-radius: 5px;
      padding: 6px 4px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 3px;
      min-height: 50px;
      text-align: center;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
    }
    
    .service-item:hover {
      background: linear-gradient(135deg, #353535 0%, #2a2a2a 100%);
      border-color: #F2BC1B;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(242, 188, 27, 0.3);
    }
    
    .service-item.active {
      background: linear-gradient(135deg, #F2BC1B 0%, #d9a616 100%);
      border-color: #F2BC1B;
      color: #000;
      font-weight: 700;
      box-shadow: 0 3px 12px rgba(242, 188, 27, 0.5);
    }
    
    .service-item.has-submenu.expanded {
      background: linear-gradient(135deg, #353535 0%, #2a2a2a 100%);
      border-color: #F2BC1B;
    }
    
    .service-submenu {
      display: none;
      flex-direction: column;
      gap: 2px;
      padding-right: 8px;
      border-right: 2px solid #F2BC1B;
      margin: 2px 0;
    }
    
    .service-submenu.show {
      display: flex;
    }
    
    .submenu-item {
      background: #252525;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 5px 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 10px;
      color: #ccc;
      text-align: center;
      font-weight: 600;
    }
    
    .submenu-item:hover {
      background: #2d2d2d;
      border-color: #F2BC1B;
      color: #F2BC1B;
    }
    
    .submenu-item.active {
      background: #F2BC1B;
      border-color: #F2BC1B;
      color: #000;
      font-weight: 700;
    }
    
    .service-item .icon {
      font-size: 18px;
    }
    
    .service-item.active .icon {
      filter: brightness(0);
    }
    
    .service-item .label {
      font-size: 10px;
      color: #F2BC1B;
      font-weight: 700;
      line-height: 1.1;
    }
    
    .service-item.active .label {
      color: #000;
    }
    
    /* Main Content */
    .main-content {
      display: flex;
      flex-direction: column;
      overflow: hidden;
      background: #0a0a0a;
      height: 100%;
    }
    
    /* Header Bar */
    .header-bar {
      background: #1a1a1a;
      border-bottom: 2px solid #F2BC1B;
      padding: 8px 14px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }
    
    .header-bar h2 {
      font-size: 18px;
      font-weight: 700;
      color: #F2BC1B;
      margin: 0;
    }
    
    .header-bar .status {
      font-size: 13px;
      color: #10b981;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .status-dot {
      width: 7px;
      height: 7px;
      background: #10b981;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    @keyframes slideDown {
      from {
        transform: translateX(-50%) translateY(-100%);
        opacity: 0;
      }
      to {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }
    }
    
    @keyframes slideUp {
      from {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }
      to {
        transform: translateX(-50%) translateY(-100%);
        opacity: 0;
      }
    }
    
    /* Content Area */
    .content-area {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 12px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      grid-auto-rows: max-content;
      gap: 10px;
      align-content: start;
    }
    
    .content-area::-webkit-scrollbar {
      width: 8px;
    }
    
    .content-area::-webkit-scrollbar-track {
      background: #1a1a1a;
    }
    
    .content-area::-webkit-scrollbar-thumb {
      background: #F2BC1B;
      border-radius: 4px;
    }
    
    /* Form Sections */
    .form-section {
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 5px;
      padding: 10px;
      height: fit-content;
    }
    
    .form-section.full-width {
      grid-column: 1 / -1;
    }
    
    .section-title {
      font-size: 14px;
      font-weight: 700;
      color: #F2BC1B;
      margin: 0 0 8px 0;
      padding-bottom: 5px;
      border-bottom: 1px solid #333;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 8px;
    }
    
    .form-field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    
    .form-field label {
      font-size: 13px;
      color: #999;
      font-weight: 600;
    }
    
    .form-control {
      background: #262626;
      border: 1px solid #404040;
      border-radius: 4px;
      padding: 8px 12px;
      color: #fff;
      font-size: 14px;
      transition: all 0.2s ease;
    }
    
    .form-control:focus {
      outline: none;
      border-color: #F2BC1B;
      background: #2d2d2d;
    }
    
    .form-control::placeholder {
      color: #666;
    }
    
    /* Buttons */
    .btn-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
      gap: 6px;
      margin-top: 6px;
    }
    
    .btn-option {
      background: #2a2a2a;
      border: 1px solid #404040;
      border-radius: 4px;
      padding: 10px 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
      font-size: 13px;
      color: #ccc;
      font-weight: 600;
    }
    
    .btn-option:hover {
      background: #353535;
      border-color: #F2BC1B;
    }
    
    .btn-option.active {
      background: #F2BC1B;
      border-color: #F2BC1B;
      color: #000;
      font-weight: 700;
    }
    
    .btn-primary {
      background: #F2BC1B;
      color: #000;
      border: none;
      padding: 12px 20px;
      border-radius: 5px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
      margin-top: 10px;
    }
    
    .btn-primary:hover {
      background: #d9a616;
      transform: translateY(-2px);
    }
    
    /* Back Button */
    .btn-back {
      background: #F2BC1B;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn-back:hover {
      background: #d9a616;
      transform: translateY(-2px);
    }
    
    /* Data Table */
    .data-table-container {
      grid-column: 1 / -1;
      background: linear-gradient(135deg, #1a1a1a 0%, #0f0f0f 100%);
      border: 2px solid #F2BC1B;
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      max-height: none;
      box-shadow: 0 4px 16px rgba(242, 188, 27, 0.3);
    }
    
    .table-header {
      background: linear-gradient(135deg, #F2BC1B 0%, #d9a616 100%);
      padding: 16px 20px;
      font-size: 17px;
      font-weight: 700;
      color: #000;
      position: sticky;
      top: 0;
      z-index: 20;
      text-align: center;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    
    .table-scroll {
      overflow: visible;
      max-height: none;
      padding: 20px;
    }
    
    .data-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
      table-layout: auto;
    }
    
    .data-table th {
      background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%);
      color: #F2BC1B;
      font-size: 15px;
      font-weight: 700;
      padding: 14px 20px;
      text-align: center;
      border: none;
      white-space: nowrap;
      position: sticky;
      top: 0;
      z-index: 10;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    }
    
    .data-table td {
      padding: 16px 20px;
      font-size: 15px;
      color: #fff;
      background: linear-gradient(135deg, #262626 0%, #1a1a1a 100%);
      text-align: center;
      border: none;
      white-space: nowrap;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    }
    
    .data-table tbody tr {
      border-radius: 8px;
      overflow: hidden;
    }
    
    .data-table tbody tr td:first-child {
      border-top-right-radius: 8px;
      border-bottom-right-radius: 8px;
    }
    
    .data-table tbody tr td:last-child {
      border-top-left-radius: 8px;
      border-bottom-left-radius: 8px;
    }
    
    .data-table tr:hover td {
      background: linear-gradient(135deg, #2d2d2d 0%, #222222 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(242, 188, 27, 0.2);
    }
    
    .data-table .highlight {
      color: #F2BC1B;
      font-weight: 700;
      font-size: 17px;
      text-shadow: 0 2px 4px rgba(242, 188, 27, 0.3);
    }
    
    /* Info Boxes */
    .info-box {
      background: #1a3a52;
      border: 1px solid #3b82f6;
      border-radius: 4px;
      padding: 10px 12px;
      font-size: 13px;
      color: #93c5fd;
      margin-top: 7px;
    }
    
    .warning-box {
      background: #4a3a1a;
      border: 1px solid #f59e0b;
      border-radius: 4px;
      padding: 10px 12px;
      font-size: 13px;
      color: #fbbf24;
      margin-top: 7px;
    }
    
    .error-box {
      background: #4a1a1a;
      border: 1px solid #ef4444;
      border-radius: 4px;
      padding: 10px 12px;
      font-size: 13px;
      color: #fca5a5;
      margin-top: 7px;
    }
    
    /* Loading */
    .spinner {
      border: 2px solid #333;
      border-top: 2px solid #F2BC1B;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      animation: spin 1s linear infinite;
      display: inline-block;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .hidden {
      display: none !important;
    }
    
    /* Fullscreen Iframe Container */
    .fullscreen-iframe-wrapper {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #0a0a0a;
      z-index: 1000;
      display: flex;
      flex-direction: column;
    }
    
    .fullscreen-iframe-header {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
      background: transparent;
      border: none;
      padding: 0;
      pointer-events: none;
    }
    
    .fullscreen-iframe-header .btn-back {
      pointer-events: all;
      background: rgba(242, 188, 27, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    .fullscreen-iframe-header .btn-back:hover {
      background: rgba(217, 166, 22, 0.95);
    }
    
    .fullscreen-iframe-container {
      flex: 1;
      width: 100%;
      overflow: hidden;
    }
    
    .fullscreen-iframe-container iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div class="dashboard-wrapper" id="dashboardWrapper"><!-- Sidebar -->
   <aside class="sidebar hidden" id="sidebar">
    <div class="logo-section"><img src="https://i.top4top.io/p_35860o72q1.png" alt="Logo">
     <h1 id="siteTitle">Ø®Ø¯Ù…Ø§Øª Ø¨ÙˆØ±ØªØ±Ø§Ø¬</h1>
    </div><!-- 1. ÙˆÙ†Ø´Ø§Øª -->
    <div class="service-item" data-service="tow"><span class="icon">ğŸšš</span> <span class="label">ÙˆÙ†Ø´Ø§Øª</span>
    </div><!-- 2. Ø¨Ø·Ø§Ø±ÙŠØ§Øª -->
    <div class="service-item has-submenu" data-group="battery"><span class="icon">ğŸ”‹</span> <span class="label">Ø¨Ø·Ø§Ø±ÙŠØ§Øª</span>
    </div>
    <div class="service-submenu" id="batterySubmenu">
     <div class="submenu-item" data-service="batterySubscription">
      Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø·Ø§Ø±ÙŠØ©
     </div>
     <div class="submenu-item" data-service="newBattery">
      Ø¨Ø·Ø§Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©
     </div>
     <div class="submenu-item" data-service="batteryInstall">
      ØªØ±ÙƒÙŠØ¨ Ø¨Ø·Ø§Ø±ÙŠØ©
     </div>
    </div><!-- 3. Ø®Ø¯Ù…Ø© Ø¨Ù†Ø²ÙŠÙ† -->
    <div class="service-item" data-service="fuel"><span class="icon">â›½</span> <span class="label">Ø®Ø¯Ù…Ø© Ø¨Ù†Ø²ÙŠÙ†</span>
    </div><!-- 4. Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª -->
    <div class="service-item has-submenu" data-group="tires"><span class="icon">ğŸ›</span> <span class="label">Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø¨Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª</span>
    </div>
    <div class="service-submenu" id="tiresSubmenu">
     <div class="submenu-item" data-service="tireSheet">
      Ø´ÙŠØª Ø§Ù„ØªÙˆØ§ÙŠØ±
     </div>
     <div class="submenu-item" data-service="tireIncrease">
      Ø²ÙŠØ§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ§ÙŠØ±
     </div>
     <div class="submenu-item" data-service="puncture">
      Ø¨Ù†Ø´Ø±
     </div>
     <div class="submenu-item" data-service="balance">
      Ù…ÙŠØ²Ø§Ù† ÙˆØªØ±ÙƒÙŠØ¨
     </div>
    </div><!-- 5. Ø®Ø¯Ù…Ø© Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© -->
    <div class="service-item" data-service="mechanical"><span class="icon">ğŸ”©</span> <span class="label">Ø®Ø¯Ù…Ø© Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©</span>
    </div><!-- 6. ØºØ³ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª -->
    <div class="service-item" data-service="carwash"><span class="icon">ğŸ’§</span> <span class="label">ØºØ³ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</span>
    </div><!-- 7. ØªØ£Ù…ÙŠÙ†Ø§Øª -->
    <div class="service-item" data-service="insurance"><span class="icon">ğŸ›¡ï¸</span> <span class="label">ØªØ£Ù…ÙŠÙ†Ø§Øª</span>
    </div>
   </aside><!-- Main Content -->
   <main class="main-content"><!-- Header Bar -->
    <header class="header-bar">
     <h2 id="serviceTitle">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>
     <div class="status"><span class="status-dot"></span> <span>Ù…ØªØµÙ„</span>
     </div>
    </header><!-- Content Area -->
    <div id="contentArea" class="content-area">
     <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px;">
      <div class="spinner" style="width: 40px; height: 40px; margin: 0 auto 20px; border-width: 4px;"></div>
      <h3 style="color: #F2BC1B; font-size: 18px; margin-bottom: 8px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google Sheets...</h3>
      <p style="color: #999; font-size: 14px;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŒ Ù‚Ø¯ ØªØ³ØªØºØ±Ù‚ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ø¶Ø¹ Ø«ÙˆØ§Ù†Ù</p>
     </div>
    </div>
   </main>
  </div><!-- Fullscreen Iframe Wrapper -->
  <div id="fullscreenIframeWrapper" class="fullscreen-iframe-wrapper hidden">
   <div class="fullscreen-iframe-header"><button class="btn-back" onclick="closeFullscreenIframe()"> <span>â†</span> <span>Ø±Ø¬ÙˆØ¹</span> </button>
   </div>
   <div class="fullscreen-iframe-container" id="fullscreenIframeContainer">
   </div>
  </div>
  <script>
    // Configuration
    const defaultConfig = {
      site_title: 'Ø®Ø¯Ù…Ø§Øª Ø¨ÙˆØ±ØªØ±Ø§Ø¬',
      sheet_id: '1x2ongtstODqEEWh_jAwN8zLHjsYeIppk8EH_Q1CXMzk',
      currency: 'Ø¯.Ùƒ'
    };

    let config = { ...defaultConfig };
    let sheetsData = {};
    let currentService = '';
    let formData = {};
    let lastIframeState = null;
    let carWashData = [];

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => {
          config = { ...defaultConfig, ...newConfig };
          document.getElementById('siteTitle').textContent = config.site_title;
          
          if (newConfig.sheet_id && newConfig.sheet_id !== sheetsData.currentSheetId) {
            await loadAllSheets();
          }
        },
        mapToCapabilities: () => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (cfg) => new Map([
          ['site_title', cfg.site_title || defaultConfig.site_title],
          ['sheet_id', cfg.sheet_id || defaultConfig.sheet_id],
          ['currency', cfg.currency || defaultConfig.currency]
        ])
      });
    }

    // Company mapping for TOW service
    const companyMapping = {
      'Ø¨ÙˆØ±ØªØ±Ø§Ø¬': 'portarage towtruk',
      'Ù‡ÙŠØ±Ùˆ ÙˆØ±ÙƒØ³': 'hero.works',
      'Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù†Ù…': 'Ahmed Al-Ghanem',
      'Ø¨ÙŠÙƒÙˆÙƒ ÙƒÙˆÙ†Ø³ÙŠØ±Ø¬': 'Peacock Concierge',
      'Ø¨Ø±ÙˆØ¬ÙƒØª Ø¥ÙƒØ³ Ø±ÙŠØ³Ù†Ù‚': 'ProjX Racing',
      'ÙŠØ§Ù…Ø§Ù‡Ø§ Ù…ÙˆØªÙˆØ±': 'Yamaha Motor',
      'ÙÙˆÙ„Øª Ù‚Ø§Ø±Ø§Ø¬': 'Vault Garage',
      'Ø¬ÙŠÙ„ÙŠ': 'Geely',
      'Ø§ÙˆØªÙˆ ÙƒØ§Ø¨ÙŠØªØ§Ù„': 'Auto Capital'
    };
    
    const companies = Object.keys(companyMapping);

    // Car Wash Packages Definition
    const carWashPackages = {
      excellent: {
        name: 'ØºØ³ÙŠÙ„ Ù…Ù…ØªØ§Ø²',
        icon: 'ğŸ‘‘',
        duration: 60,
        prices: { sedan: 7, suv: 8 },
        services: [
          'ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ',
          'ØªÙ†Ø¸ÙŠÙ Ø¯Ø§Ø®Ù„ÙŠ',
          'ØªÙ„Ù…ÙŠØ¹ Ø§Ù„ØªÙˆØ§ÙŠØ± ÙˆØ§Ù„Ø±Ù†Ù‚Ø§Øª',
          'ØªÙ†Ø¸ÙŠÙ ÙØªØ­Ø§Øª Ø§Ù„ØªÙƒÙŠÙŠÙ',
          'Ø¹Ø·Ø±'
        ]
      },
      special: {
        name: 'ØºØ³ÙŠÙ„ Ø®ØµÙˆØµÙŠ',
        icon: 'ğŸ’',
        duration: 120,
        prices: { sedan: 15, suv: 17 },
        services: [
          'ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ',
          'Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ',
          'ØªÙ„Ù…ÙŠØ¹ Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©',
          'Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ù‚Ø¹ Ø§Ù„Ø®ÙÙŠÙØ© Ù…Ù† Ø¯Ø§Ø®Ù„ÙŠØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø©',
          'ØªÙ„Ù…ÙŠØ¹ Ø§Ù„ØªÙˆØ§ÙŠØ± ÙˆØ§Ù„Ø±Ù†Ù‚Ø§Øª',
          'ØªÙ†Ø¸ÙŠÙ ÙØªØ­Ø§Øª Ø§Ù„ØªÙƒÙŠÙŠÙ',
          'Ø¹Ø·Ø±'
        ]
      },
      ultra: {
        name: 'ØºØ³ÙŠÙ„ Ø§Ù„ØªØ±Ø§',
        icon: 'â­',
        duration: 180,
        prices: { sedan: 30, suv: 35 },
        services: [
          'ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ',
          'Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ',
          'ØªÙ„Ù…ÙŠØ¹ Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©',
          'ØºØ³ÙŠÙ„ Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø©',
          'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨',
          'ØºØ³ÙŠÙ„ Ø¯Ø¨Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©',
          'ØªÙ†Ø¸ÙŠÙ Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©'
        ]
      }
    };

    // Parse CSV
    function parseCSV(csvText) {
      const rows = [];
      const lines = csvText.split('\n');
      
      for (let line of lines) {
        if (!line.trim()) continue;
        
        const cells = [];
        let cell = '';
        let inQuotes = false;
        
        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          
          if (char === '"') {
            if (inQuotes && line[i + 1] === '"') {
              cell += '"';
              i++;
            } else {
              inQuotes = !inQuotes;
            }
          } else if (char === ',' && !inQuotes) {
            cells.push(cell.replace(/^"|"$/g, ''));
            cell = '';
          } else {
            cell += char;
          }
        }
        cells.push(cell.replace(/^"|"$/g, ''));
        rows.push(cells);
      }
      
      return rows;
    }

    // Load all sheets
    async function loadAllSheets() {
      try {
        const sheetId = config.sheet_id;
        
        const sheetNames = [
          'portarage towtruk', 'hero.works', 'Ahmed Al-Ghanem', 'Peacock Concierge',
          'ProjX Racing', 'Yamaha Motor', 'Vault Garage', 'Geely', 'Auto Capital',
          'Ø®Ø¯Ù…Ø§Øª5', 'Ù…ÙŠØ²Ø§Ù† ÙˆØªØ±ÙƒÙŠØ¨', 'Ø®Ø¯Ù…Ø§Øª Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©', 'ØªØ±ÙƒÙŠØ¨ Ø¨Ø·Ø§Ø±ÙŠØ©',
          'ØªØ£Ù…ÙŠÙ† ÙˆØ±Ø¨Ù‡', 'ØªØ£Ù…ÙŠÙ† ØµÙÙŠÙ†Ù‡ VIP', 'ØªØ£Ù…ÙŠÙ† Ø¥ÙŠÙ„Ø§Ù'
        ];
        
        sheetsData = { currentSheetId: sheetId };
        
        for (const sheetName of sheetNames) {
          try {
            const csvUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(sheetName)}`;
            const response = await fetch(csvUrl);
            
            if (response.ok) {
              const csvText = await response.text();
              const rows = parseCSV(csvText);
              sheetsData[sheetName] = rows;
            }
          } catch (err) {
            console.log(`Could not load sheet: ${sheetName}`);
          }
        }
        
        document.getElementById('sidebar').classList.remove('hidden');
        document.getElementById('serviceTitle').textContent = 'Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©';
        
        const contentArea = document.getElementById('contentArea');
        contentArea.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px;">
            <div style="font-size: 48px; margin-bottom: 16px;">âœ…</div>
            <h3 style="color: #10b981; font-size: 18px; margin-bottom: 8px;">ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!</h3>
            <p style="color: #999; font-size: 14px;">Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ù„Ù„Ø¨Ø¯Ø¡</p>
          </div>
        `;
        
      } catch (error) {
        console.error('Error loading sheets:', error);
        
        const contentArea = document.getElementById('contentArea');
        contentArea.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px;">
            <div style="font-size: 48px; margin-bottom: 16px;">âŒ</div>
            <h3 style="color: #ef4444; font-size: 18px; margin-bottom: 8px;">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <p style="color: #999; font-size: 14px;">ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</p>
            <button onclick="location.reload()" class="btn-primary" style="max-width: 200px; margin: 20px auto 0;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
          </div>
        `;
        
        document.getElementById('serviceTitle').textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„';
      }
    }

    // Fullscreen iframe functions
    function openFullscreenIframe(url, title) {
      const wrapper = document.getElementById('fullscreenIframeWrapper');
      const container = document.getElementById('fullscreenIframeContainer');
      
      lastIframeState = { url, title, service: currentService, formData: { ...formData } };
      
      container.innerHTML = `<iframe src="${url}" title="${title}"></iframe>`;
      wrapper.classList.remove('hidden');
      document.getElementById('dashboardWrapper').style.display = 'none';
    }

    window.closeFullscreenIframe = function() {
      const wrapper = document.getElementById('fullscreenIframeWrapper');
      const container = document.getElementById('fullscreenIframeContainer');
      
      wrapper.classList.add('hidden');
      container.innerHTML = '';
      document.getElementById('dashboardWrapper').style.display = 'grid';
      
      showSuccessMessage('âœ“ ØªÙ… Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­');
      
      if (lastIframeState && lastIframeState.service) {
        currentService = lastIframeState.service;
        formData = { ...lastIframeState.formData };
        
        setTimeout(() => {
          document.querySelectorAll('.service-item, .submenu-item').forEach(item => item.classList.remove('active'));
          
          const serviceTitles = {
            'newBattery': 'Ø¨Ø·Ø§Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©',
            'tireSheet': 'Ø´ÙŠØª Ø§Ù„ØªÙˆØ§ÙŠØ±',
            'tireIncrease': 'Ø²ÙŠØ§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ§ÙŠØ±'
          };
          
          document.getElementById('serviceTitle').textContent = serviceTitles[lastIframeState.service] || lastIframeState.title;
          
          const contentArea = document.getElementById('contentArea');
          contentArea.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px;">
              <div style="font-size: 48px; margin-bottom: 16px;">âœ…</div>
              <h3 style="color: #10b981; font-size: 18px; margin-bottom: 8px;">ØªÙ… Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­!</h3>
              <p style="color: #999; font-size: 14px;">Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© Ø£Ø®Ø±Ù‰ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©</p>
            </div>
          `;
        }, 100);
      }
    };
    
    function showSuccessMessage(message) {
      const existingMessage = document.getElementById('successMessage');
      if (existingMessage) existingMessage.remove();
      
      const messageDiv = document.createElement('div');
      messageDiv.id = 'successMessage';
      messageDiv.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 16px 24px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 700;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        z-index: 10000;
        animation: slideDown 0.3s ease-out;
      `;
      messageDiv.textContent = message;
      
      document.body.appendChild(messageDiv);
      
      setTimeout(() => {
        messageDiv.style.animation = 'slideUp 0.3s ease-in';
        setTimeout(() => messageDiv.remove(), 300);
      }, 2500);
    }

    // Event handlers
    document.addEventListener('click', (e) => {
      const groupItem = e.target.closest('[data-group]');
      if (groupItem) {
        const group = groupItem.dataset.group;
        const submenu = document.getElementById(`${group}Submenu`);
        
        if (submenu) {
          const isExpanded = submenu.classList.contains('show');
          document.querySelectorAll('.service-submenu').forEach(menu => menu.classList.remove('show'));
          document.querySelectorAll('.service-item.has-submenu').forEach(item => item.classList.remove('expanded'));
          
          if (!isExpanded) {
            submenu.classList.add('show');
            groupItem.classList.add('expanded');
          }
        }
        return;
      }
      
      const submenuItem = e.target.closest('.submenu-item');
      if (submenuItem && submenuItem.dataset.service) {
        document.querySelectorAll('.service-item, .submenu-item').forEach(item => item.classList.remove('active'));
        submenuItem.classList.add('active');
        
        currentService = submenuItem.dataset.service;
        formData = {};
        handleServiceSelection(currentService);
        return;
      }
      
      const serviceItem = e.target.closest('.service-item:not(.has-submenu)');
      if (serviceItem && serviceItem.dataset.service) {
        document.querySelectorAll('.service-item, .submenu-item').forEach(item => item.classList.remove('active'));
        serviceItem.classList.add('active');
        
        currentService = serviceItem.dataset.service;
        formData = {};
        handleServiceSelection(currentService);
      }
    });

    function handleServiceSelection(service) {
      const serviceTitles = {
        'tow': 'Ø®Ø¯Ù…Ø© ÙˆÙ†Ø´Ø§Øª',
        'batterySubscription': 'Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø·Ø§Ø±ÙŠØ©',
        'newBattery': 'Ø¨Ø·Ø§Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©',
        'batteryInstall': 'ØªØ±ÙƒÙŠØ¨ Ø¨Ø·Ø§Ø±ÙŠØ©',
        'fuel': 'Ø®Ø¯Ù…Ø© Ø¨Ù†Ø²ÙŠÙ†',
        'tireSheet': 'Ø´ÙŠØª Ø§Ù„ØªÙˆØ§ÙŠØ±',
        'tireIncrease': 'Ø²ÙŠØ§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ§ÙŠØ±',
        'puncture': 'Ø¨Ù†Ø´Ø±',
        'balance': 'Ù…ÙŠØ²Ø§Ù† ÙˆØªØ±ÙƒÙŠØ¨',
        'mechanical': 'Ø®Ø¯Ù…Ø§Øª Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©',
        'carwash': 'ØºØ³ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª',
        'insurance': 'ØªØ£Ù…ÙŠÙ†Ø§Øª'
      };
      
      document.getElementById('serviceTitle').textContent = serviceTitles[service];
      
      switch(service) {
        case 'tow':
          renderTowInterface();
          break;
        case 'batterySubscription':
          renderBatterySubscriptionInterface();
          break;
        case 'newBattery':
          openFullscreenIframe('https://portaragebatteries.netlify.app/', 'Ø¨Ø·Ø§Ø±ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©');
          break;
        case 'batteryInstall':
          renderBatteryInstallInterface();
          break;
        case 'fuel':
          renderFuelInterface();
          break;
        case 'tireSheet':
          openFullscreenIframe('https://portiers.netlify.app/', 'Ø´ÙŠØª Ø§Ù„ØªÙˆØ§ÙŠØ±');
          break;
        case 'tireIncrease':
          openFullscreenIframe('https://portaragetiers.netlify.app/', 'Ø²ÙŠØ§Ø¯Ø§Øª Ø§Ù„ØªÙˆØ§ÙŠØ±');
          break;
        case 'puncture':
          renderPunctureService();
          break;
        case 'balance':
          renderBalanceService();
          break;
        case 'mechanical':
          renderMechanicalInterface();
          break;
        case 'carwash':
          renderCarWashSystem();
          break;
        case 'insurance':
          renderInsuranceInterface();
          break;
      }
    }

    // CAR WASH SYSTEM
    async function renderCarWashSystem() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      
      // Load car wash data from Google Sheets
      const carWashSheetId = '1FkWKRxRFC8UG1Ez2VzYHadHju2HARBLbdTIsr57hKXc';
      carWashData = [];
      
      try {
        const csvUrl = `https://docs.google.com/spreadsheets/d/${carWashSheetId}/gviz/tq?tqx=out:csv&sheet=Sheet1`;
        const response = await fetch(csvUrl);
        if (response.ok) {
          const csvText = await response.text();
          const rows = parseCSV(csvText);
          if (rows.length > 1) {
            carWashData = rows.slice(1).map(row => ({
              date: row[0] || '',
              time: row[1] || '',
              qrOrder: row[2] || '',
              customerName: row[3] || '',
              customerNumber: row[4] || '',
              customerLocation: row[5] || '',
              washType: row[6] || '',
              payment: row[7] || ''
            })).filter(item => item.date && item.time);
          }
        }
      } catch (error) {
        console.error('Error loading car wash data:', error);
      }
      
      contentArea.innerHTML = `
        <!-- Type Selection -->
        <div class="form-section full-width">
          <h3 class="section-title">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØºØ³ÙŠÙ„</h3>
          <div class="btn-grid">
            <button class="btn-option active" data-wash="all">Ø§Ù„ÙƒÙ„</button>
            <button class="btn-option" data-wash="excellent">ØºØ³ÙŠÙ„ Ù…Ù…ØªØ§Ø²</button>
            <button class="btn-option" data-wash="special">ØºØ³ÙŠÙ„ Ø®ØµÙˆØµÙŠ</button>
            <button class="btn-option" data-wash="ultra">ØºØ³ÙŠÙ„ Ø§Ù„ØªØ±Ø§</button>
          </div>
        </div>

        <!-- Wash Details Cards -->
        <div class="form-section" id="excellentCard">
          <h3 class="section-title" style="color: #F2BC1B; font-size: 16px;">ğŸ‘‘ ØºØ³ÙŠÙ„ Ù…Ù…ØªØ§Ø²</h3>
          <div style="margin-bottom: 12px;">
            <p style="color: #10b981; font-size: 14px; font-weight: 700; margin-bottom: 8px;">â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØºØ³ÙŠÙ„: Ø³Ø§Ø¹Ø© ÙˆØ§Ø­Ø¯Ø©</p>
            <div style="display: flex; justify-content: space-around; margin-bottom: 10px; padding: 10px; background: #1a1a1a; border-radius: 4px; border: 1px solid #333;">
              <div style="text-align: center;">
                <div style="color: #999; font-size: 12px;">ØµØ§Ù„ÙˆÙ†</div>
                <div style="color: #F2BC1B; font-size: 16px; font-weight: 700;">7 ${config.currency}</div>
              </div>
              <div style="text-align: center;">
                <div style="color: #999; font-size: 12px;">Ø¬ÙŠØ¨</div>
                <div style="color: #F2BC1B; font-size: 16px; font-weight: 700;">8 ${config.currency}</div>
              </div>
            </div>
          </div>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ†Ø¸ÙŠÙ Ø¯Ø§Ø®Ù„ÙŠ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ„Ù…ÙŠØ¹ Ø§Ù„ØªÙˆØ§ÙŠØ± ÙˆØ§Ù„Ø±Ù†Ù‚Ø§Øª
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ†Ø¸ÙŠÙ ÙØªØ­Ø§Øª Ø§Ù„ØªÙƒÙŠÙŠÙ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              Ø¹Ø·Ø±
            </li>
          </ul>
          <button class="btn-primary" style="margin-top: 10px; padding: 10px;" onclick="copyWashInfo('excellent')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
        </div>

        <div class="form-section" id="specialCard">
          <h3 class="section-title" style="color: #F2BC1B; font-size: 16px;">ğŸ’ ØºØ³ÙŠÙ„ Ø®ØµÙˆØµÙŠ</h3>
          <div style="margin-bottom: 12px;">
            <p style="color: #10b981; font-size: 14px; font-weight: 700; margin-bottom: 8px;">â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØºØ³ÙŠÙ„: Ø³Ø§Ø¹ØªØ§Ù†</p>
            <div style="display: flex; justify-content: space-around; margin-bottom: 10px; padding: 10px; background: #1a1a1a; border-radius: 4px; border: 1px solid #333;">
              <div style="text-align: center;">
                <div style="color: #999; font-size: 12px;">ØµØ§Ù„ÙˆÙ†</div>
                <div style="color: #F2BC1B; font-size: 16px; font-weight: 700;">15 ${config.currency}</div>
              </div>
              <div style="text-align: center;">
                <div style="color: #999; font-size: 12px;">Ø¬ÙŠØ¨</div>
                <div style="color: #F2BC1B; font-size: 16px; font-weight: 700;">17 ${config.currency}</div>
              </div>
            </div>
          </div>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ„Ù…ÙŠØ¹ Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨Ù‚Ø¹ Ø§Ù„Ø®ÙÙŠÙØ© Ù…Ù† Ø¯Ø§Ø®Ù„ÙŠØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø©
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ„Ù…ÙŠØ¹ Ø§Ù„ØªÙˆØ§ÙŠØ± ÙˆØ§Ù„Ø±Ù†Ù‚Ø§Øª
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ†Ø¸ÙŠÙ ÙØªØ­Ø§Øª Ø§Ù„ØªÙƒÙŠÙŠÙ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              Ø¹Ø·Ø±
            </li>
          </ul>
          <button class="btn-primary" style="margin-top: 10px; padding: 10px;" onclick="copyWashInfo('special')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
        </div>

        <div class="form-section" id="ultraCard">
          <h3 class="section-title" style="color: #F2BC1B; font-size: 16px;">â­ ØºØ³ÙŠÙ„ Ø§Ù„ØªØ±Ø§</h3>
          <div style="margin-bottom: 12px;">
            <p style="color: #10b981; font-size: 14px; font-weight: 700; margin-bottom: 8px;">â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØºØ³ÙŠÙ„: 3 Ø³Ø§Ø¹Ø§Øª</p>
            <div style="display: flex; justify-content: space-around; margin-bottom: 10px; padding: 10px; background: #1a1a1a; border-radius: 4px; border: 1px solid #333;">
              <div style="text-align: center;">
                <div style="color: #999; font-size: 12px;">ØµØ§Ù„ÙˆÙ†</div>
                <div style="color: #F2BC1B; font-size: 16px; font-weight: 700;">30 ${config.currency}</div>
              </div>
              <div style="text-align: center;">
                <div style="color: #999; font-size: 12px;">Ø¬ÙŠØ¨</div>
                <div style="color: #F2BC1B; font-size: 16px; font-weight: 700;">35 ${config.currency}</div>
              </div>
            </div>
          </div>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ„Ù…ÙŠØ¹ Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØºØ³ÙŠÙ„ Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØºØ³ÙŠÙ„ Ø¯Ø¨Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©
            </li>
            <li style="color: #ccc; font-size: 13px; margin-bottom: 6px; padding-right: 20px; position: relative;">
              <span style="position: absolute; right: 0; color: #10b981; font-weight: 700;">âœ“</span>
              ØªÙ†Ø¸ÙŠÙ Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©
            </li>
          </ul>
          <button class="btn-primary" style="margin-top: 10px; padding: 10px;" onclick="copyWashInfo('ultra')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
        </div>

        <!-- Copy All Button (shown only when "Ø§Ù„ÙƒÙ„" is selected) -->
        <div class="form-section full-width" id="copyAllSection">
          <button class="btn-primary" style="padding: 14px; font-size: 16px;" onclick="copyAllWashInfo()">ğŸ“‹ Ù†Ø³Ø® Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
        </div>

        <!-- Date Filter -->
        <div class="form-section full-width">
          <h3 class="section-title">ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®</h3>
          <div class="form-field">
            <label for="carWashDateFilter">Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
            <input type="date" id="carWashDateFilter" class="form-control">
          </div>
          <div class="info-box" id="nextAvailableTime" style="margin-top: 10px;"></div>
        </div>

        <!-- Bookings Table -->
        <div class="data-table-container" id="carWashBookingsTable">
          <div class="table-header">ğŸ“Š Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø©</div>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                  <th>Ø§Ù„ÙˆÙ‚Øª</th>
                  <th>QR ORDER</th>
                  <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                  <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                  <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                  <th>Ù†ÙˆØ¹ Ø§Ù„ØºØ³ÙŠÙ„</th>
                  <th>Ø§Ù„Ø¯ÙØ¹</th>
                </tr>
              </thead>
              <tbody id="carWashBookingsBody"></tbody>
            </table>
          </div>
        </div>
      `;
      
      // Initialize
      initCarWashSystem();
      updateCarWashTable();
      
      // Setup date filter
      const dateFilter = document.getElementById('carWashDateFilter');
      const today = new Date().toISOString().split('T')[0];
      dateFilter.value = today;
      dateFilter.min = today;
      
      dateFilter.addEventListener('change', () => {
        updateCarWashTable();
        calculateNextAvailableTime();
      });
      
      calculateNextAvailableTime();
    }

    function initCarWashSystem() {
      // Wash type selection
      document.querySelectorAll('[data-wash]').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('[data-wash]').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          const washType = btn.dataset.wash;
          
          if (washType === 'all') {
            document.getElementById('excellentCard').style.display = 'block';
            document.getElementById('specialCard').style.display = 'block';
            document.getElementById('ultraCard').style.display = 'block';
            document.getElementById('copyAllSection').style.display = 'block';
          } else {
            document.getElementById('excellentCard').style.display = washType === 'excellent' ? 'block' : 'none';
            document.getElementById('specialCard').style.display = washType === 'special' ? 'block' : 'none';
            document.getElementById('ultraCard').style.display = washType === 'ultra' ? 'block' : 'none';
            document.getElementById('copyAllSection').style.display = 'none';
          }
        });
      });
    }

    function updateCarWashTable() {
      const dateFilter = document.getElementById('carWashDateFilter').value;
      const tbody = document.getElementById('carWashBookingsBody');
      
      if (!tbody) return;
      
      const filteredData = carWashData.filter(item => {
        if (!dateFilter) return true;
        return item.date === dateFilter;
      });
      
      if (filteredData.length === 0) {
        tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; color: #999;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù…Ø­Ø¬ÙˆØ²Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®</td></tr>';
        return;
      }
      
      tbody.innerHTML = filteredData.map(item => `
        <tr>
          <td>${item.date}</td>
          <td class="highlight">${item.time}</td>
          <td>${item.qrOrder}</td>
          <td>${item.customerName}</td>
          <td>${item.customerNumber}</td>
          <td>${item.customerLocation}</td>
          <td class="highlight">${item.washType}</td>
          <td>${item.payment}</td>
        </tr>
      `).join('');
    }

    function calculateNextAvailableTime() {
      const dateFilter = document.getElementById('carWashDateFilter').value;
      const infoBox = document.getElementById('nextAvailableTime');
      
      if (!dateFilter || !infoBox) return;
      
      const dayBookings = carWashData.filter(b => b.date === dateFilter);
      
      if (dayBookings.length === 0) {
        infoBox.innerHTML = 'âœ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù…Ø­Ø¬ÙˆØ²Ø© - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ù…ØªØ§Ø­Ø© Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø© 10:00 ØµØ¨Ø§Ø­Ø§Ù‹';
        return;
      }
      
      // Sort bookings by time
      dayBookings.sort((a, b) => {
        const timeA = a.time.split(':').map(Number);
        const timeB = b.time.split(':').map(Number);
        return (timeA[0] * 60 + timeA[1]) - (timeB[0] * 60 + timeB[1]);
      });
      
      // Get last booking
      const lastBooking = dayBookings[dayBookings.length - 1];
      const [hours, minutes] = lastBooking.time.split(':').map(Number);
      const lastBookingMinutes = hours * 60 + minutes;
      
      // Determine wash duration (assume longest if not specified)
      let washDuration = 60; // default
      const washType = lastBooking.washType.toLowerCase();
      
      if (washType.includes('Ù…Ù…ØªØ§Ø²')) washDuration = 60;
      else if (washType.includes('Ø®ØµÙˆØµÙŠ')) washDuration = 120;
      else if (washType.includes('ØªØ±Ø§') || washType.includes('ultra')) washDuration = 180;
      
      // Calculate next available time: last booking time + wash duration + 30 min travel
      const nextAvailableMinutes = lastBookingMinutes + washDuration + 30;
      const nextHours = Math.floor(nextAvailableMinutes / 60);
      const nextMins = nextAvailableMinutes % 60;
      const nextTime = `${String(nextHours).padStart(2, '0')}:${String(nextMins).padStart(2, '0')}`;
      
      infoBox.innerHTML = `â° Ø¢Ø®Ø± Ù…ÙˆØ¹Ø¯ Ù…Ø­Ø¬ÙˆØ²: ${lastBooking.time} (${lastBooking.washType})<br>
        âœ“ Ø£Ù‚Ø±Ø¨ Ù…ÙˆØ¹Ø¯ Ù…ØªØ§Ø­: ${nextTime} (Ø¨Ø¹Ø¯ ${washDuration / 60} Ø³Ø§Ø¹Ø© ØºØ³ÙŠÙ„ + 30 Ø¯Ù‚ÙŠÙ‚Ø© Ø·Ø±ÙŠÙ‚)`;
    }

    window.copyWashInfo = function(type) {
      const pkg = carWashPackages[type];
      
      let text = `${pkg.icon} ${pkg.name}\n`;
      text += `â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØºØ³ÙŠÙ„: ${pkg.duration / 60} Ø³Ø§Ø¹Ø©\n\n`;
      text += `Ø§Ù„Ø£Ø³Ø¹Ø§Ø±:\n`;
      text += `ğŸš— ØµØ§Ù„ÙˆÙ†: ${pkg.prices.sedan} ${config.currency}\n`;
      text += `ğŸš™ Ø¬ÙŠØ¨: ${pkg.prices.suv} ${config.currency}\n\n`;
      text += `Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ¶Ù…Ù†Ø©:\n`;
      pkg.services.forEach(service => {
        text += `âœ“ ${service}\n`;
      });
      
      navigator.clipboard.writeText(text).then(() => {
        showSuccessMessage('âœ“ ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
      });
    };

    window.copyAllWashInfo = function() {
      let text = 'ğŸš— Ø®Ø¯Ù…Ø§Øª ØºØ³ÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª ğŸš—\n\n';
      
      ['excellent', 'special', 'ultra'].forEach(type => {
        const pkg = carWashPackages[type];
        
        text += `${pkg.icon} ${pkg.name}\n`;
        text += `â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØºØ³ÙŠÙ„: ${pkg.duration / 60} Ø³Ø§Ø¹Ø©\n`;
        text += `Ø§Ù„Ø£Ø³Ø¹Ø§Ø±: ØµØ§Ù„ÙˆÙ† ${pkg.prices.sedan} ${config.currency} | Ø¬ÙŠØ¨ ${pkg.prices.suv} ${config.currency}\n`;
        text += `Ø§Ù„Ø®Ø¯Ù…Ø§Øª:\n`;
        pkg.services.forEach(service => {
          text += `  âœ“ ${service}\n`;
        });
        text += '\n';
      });
      
      navigator.clipboard.writeText(text).then(() => {
        showSuccessMessage('âœ“ ØªÙ… Ù†Ø³Ø® Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
      });
    };

    // PLACEHOLDER FUNCTIONS FOR OTHER SERVICES
    function renderTowInterface() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">Ø®Ø¯Ù…Ø© ÙˆÙ†Ø´Ø§Øª</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderBatterySubscriptionInterface() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø·Ø§Ø±ÙŠØ©</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderBatteryInstallInterface() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">ØªØ±ÙƒÙŠØ¨ Ø¨Ø·Ø§Ø±ÙŠØ©</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderFuelInterface() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">Ø®Ø¯Ù…Ø© Ø¨Ù†Ø²ÙŠÙ†</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderPunctureService() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">Ø¨Ù†Ø´Ø±</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderBalanceService() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">Ù…ÙŠØ²Ø§Ù† ÙˆØªØ±ÙƒÙŠØ¨</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderMechanicalInterface() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">Ø®Ø¯Ù…Ø§Øª Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ©</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    function renderInsuranceInterface() {
      const contentArea = document.getElementById('contentArea');
      contentArea.style.display = 'grid';
      contentArea.style.gridTemplateColumns = 'repeat(auto-fit, minmax(250px, 1fr))';
      contentArea.style.background = '#0a0a0a';
      contentArea.innerHTML = `
        <div class="form-section full-width">
          <h3 class="section-title">ØªØ£Ù…ÙŠÙ†Ø§Øª</h3>
          <p style="color: #999; text-align: center; padding: 40px;">Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù‚Ø±ÙŠØ¨Ø§Ù‹...</p>
        </div>
      `;
    }

    // Load data on page load
    loadAllSheets();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b5a32d737c35cea',t:'MTc2NzAyMDc1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
